@using System.Text.RegularExpressions
@using Umbraco.Cms.Core.Models
@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{

    Layout = "main.cshtml";
    var carousel = Model.Value<IEnumerable<MediaWithCrops>>("pageImages");
    var home = Model.AncestorsOrSelf().Last();
    var favicon = home?.Value<MediaWithCrops>("siteFavicon");
    var menu = Model.Value<IEnumerable<BlockListItem>>("restaurantMenu")?.ToList() ?? new();
    var tabIndex = 0;

}

@section openGraph
{

    <title>@Model.Value("pageTitle")</title>
    <meta name="description" content="@Model.Value("pageSubtitle")">
    <meta name="author" content="@Model.Name">
    <link rel="icon" href="@favicon?.Url()" type="image/png" sizes="32x32">
    <meta name="robots" content="index, follow">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="@Model.Url()">
    <meta property="og:type" content="website">
    <meta property="og:title" content="@Model.Value("pageTitle")">
    <meta property="og:description" content="@Model.Value("pageSubtitle")">
    <meta property="og:image" content="@favicon?.Url()">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="belishankara.com">
    <meta property="twitter:url" content="@Model.Url()">
    <meta name="twitter:title" content="@Model.Value("pageTitle")">
    <meta name="twitter:description" content="@Model.Value("pageSubtitle")">
    <meta name="twitter:image" content="@favicon?.Url()">

}



@if(carousel != null && carousel.Any())
{
    <!-- Restaurant Slider -->
    <header class="header slider">
        <div class="owl-carousel owl-theme">
            <!-- The opacity on the image is made with "data-overlay-dark="number". You can change it using the numbers 0-9. -->
            @foreach(var item in carousel)
            {
                <div class="text-center item bg-img" data-overlay-dark="5" data-background="@item.Url()"></div>
            }
        </div>
        <!-- arrow down -->
        <div class="arrow bounce text-center">
            <a href="#" data-scroll-nav="1" class=""> <i class="ti-arrow-down"></i> </a>
        </div>
    </header>
}
<!-- Restaurant Content -->
    <section class="rooms-page section-padding" data-scroll-index="1">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-left"> 
                    <span>
                        <i class="star-rating"></i>
                        <i class="star-rating"></i>
                        <i class="star-rating"></i>
                        <i class="star-rating"></i>
                        <i class="star-rating"></i>
                    </span>
                    <div class="section-subtitle">@Model.Value("pageSubtitle")</div>
                    <div class="section-title">@Model.Value("pageTitle")</div>
                </div>
                <div class="col-md-12">
                    @Html.Raw(Model.Value("pageText"))
                </div>
            </div>
        </div>
    </section>
@if(menu != null)
{
    <!-- Restaurant Menu -->
    <section id="menu" class="restaurant-menu menu section-padding bg-darkblack">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-center">
                    <div class="section-subtitle"><span>Luxury Hotel</span></div>
                    <div class="section-title">Restaurant Menu</div>
                </div>
            </div>
            <div class="row">
                <div class="tabs-icon col-md-10 offset-md-1 text-center">
                    <div class="owl-carousel owl-theme">
                        @foreach (var cat in menu)
                        {
                            tabIndex++;
                            var tabId = $"tab-{tabIndex}";
                            var contentId = $"{tabId}-content";
                            var title = cat.Content.Value<string>("menuCategory");

                            <div class="item @(tabIndex == 1 ? "active" : "")"
                                 id="@tabId"
                                 data-target="#@contentId">
                                <h6>@title</h6>
                            </div>
                        }
                    </div>
                </div>

                <div class="restaurant-menu-content col-md-12">
                    @{
                        tabIndex = 0;
                    }
                    @foreach (var cat in menu)
                    {
                        tabIndex++;
                        var tabId = $"tab-{tabIndex}";
                        var contentId = $"{tabId}-content";

                        var items = cat.Content.Value<IEnumerable<BlockListItem>>("menuItems")?.ToList()
                        ?? new List<BlockListItem>();

                        var half = (items.Count + 1) / 2;

                        <div id="@contentId" class="cont @(tabIndex == 1 ? "active" : "")">
                            <div class="row">
                                <div class="col-md-6">
                                    @foreach (var bi in items.Take(half))
                                    {
                                        var c = bi.Content;
                                        <div class="menu-info">
                                            <h5>@c.Value("dishTitle") <span class="price">@c.Value("dishPrice")</span></h5>
                                            <p>@c.Value("dishText")</p>
                                        </div>
                                    }
                                </div>

                                <div class="col-md-6">
                                    @foreach (var bi in items.Skip(half))
                                    {
                                        var c = bi.Content;
                                        <div class="menu-info">
                                            <h5>@c.Value("dishTitle") <span class="price">@c.Value("dishPrice")</span></h5>
                                            <p>@c.Value("dishText")</p>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </section>

}